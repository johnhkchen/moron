---
id: T-009-03
story: S-009
title: element-layout-system
type: task
status: done
priority: high
phase: done
depends_on: []
blocks: [T-009-04]
---

## Context

Every element in `MoronFrame` renders with `position: absolute; inset: 0; display: flex; align-items: center; justify-content: center`. This means every element occupies the full 1920x1080 frame and sits dead-center. When multiple elements are visible on the same slide (title + bullets, section header + show text), they stack directly on top of each other and are unreadable.

A polished explainer video needs slides with composed layouts: title at the top, content in the center or below, metrics centered with labels underneath. The current renderer has zero layout intelligence.

### Relevant code

- `packages/ui/src/MoronFrame.tsx` — Element wrapper (lines ~221-231) uses `inset: 0` for all elements
- `moron-core/src/frame.rs` — `ElementState` has no layout/position fields
- `packages/ui/src/types.ts` — `ElementState` interface, no layout fields
- `moron-core/src/facade.rs` — `ElementKind` variants (Title, Section, Show, Steps, Metric)

### Design considerations

- Layout should be automatic based on element kinds and co-visible elements, not manually specified by scene authors (convention over configuration)
- A slide with just a Title should center it. A slide with Title + Steps should put the title in the upper third and steps in the center. A slide with Section + Show should stack them vertically with spacing.
- The Rust side should compute layout positions (so frame state JSON is deterministic). React should consume position data, not compute layout.
- Keep it simple: a slot-based system (top/center/bottom) or vertical flow layout is sufficient for v1.

## Acceptance Criteria

- `ElementState` gains layout positioning data (e.g., vertical slot, offsets) computed by Rust
- `compute_frame_state()` assigns layout positions based on element kinds and what's visible on the current "slide" (between clear() calls)
- `MoronFrame` uses the layout data to position elements instead of centering everything
- A slide with one element centers it. A slide with two elements stacks them vertically with spacing. A slide with three+ distributes them.
- Title and Section elements favor the upper area. Steps and Show elements favor the center/lower area. Metrics center.
- Unit tests verify layout positioning for common slide compositions (title-only, title+steps, section+show+steps)
- React app builds, visual output shows elements not overlapping
