---
id: T-005-01
story: S-005
title: ffmpeg-encoding
type: task
status: open
priority: high
phase: ready
depends_on: [T-004-04]
blocks: [T-005-02, T-005-03]
---

## Context

Integrate FFmpeg for encoding rendered PNG frames into H.264 video. moron-core spawns an FFmpeg subprocess, pipes frames (either from disk or stdin), and produces an .mp4 file.

The FFmpeg module should:
1. Detect FFmpeg on the system PATH (error clearly if not found)
2. Accept a directory of numbered PNGs or a frame-by-frame pipe
3. Encode to H.264 at the timeline's FPS
4. Support resolution (default 1920x1080) and quality settings
5. Output to a specified .mp4 path

Use `std::process::Command` for FFmpeg spawning â€” no Rust FFmpeg bindings needed.

Files: moron-core/src/ffmpeg.rs (replace stub)

## Acceptance Criteria

- Can encode a directory of PNG frames into a valid .mp4
- Configurable FPS, resolution, output path
- Detects missing FFmpeg with clear error message
- H.264 codec, MP4 container
- Integration test: encode a few test PNGs, verify output file exists and is valid
